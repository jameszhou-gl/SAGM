[37m[36mINFO[0m[0m 03/13 10:52:34 | Command :: train_all.py CB0 --dataset CelebA_Blond --data_dir /home/guanglinzhou/scratch/domainbed/dataset --deterministic --trial_seed 0 --algorithm SAGM_DG --alpha 0.001 --lr 1e-5 --weight_decay 1e-4 --resnet_dropout 0.5 --swad False --steps 3000
Environment:
	Python: 3.11.5
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.26.2
	PIL: 10.1.0
Args:
	algorithm: SAGM_DG
	checkpoint_freq: None
	configs: []
	data_dir: /home/guanglinzhou/scratch/domainbed/dataset
	dataset: CelebA_Blond
	debug: False
	deterministic: True
	evalmode: fast
	holdout_fraction: 0.2
	model_save: None
	name: CB0
	out_dir: train_output/CelebA_Blond/240313_10-52-34_CB0
	out_root: train_output/CelebA_Blond
	prebuild_loader: False
	seed: 0
	show: False
	steps: 3000
	tb_freq: 10
	test_envs: None
	trial_seed: 0
	unique_name: 240313_10-52-34_CB0
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	[36mresnet_dropout: 0.5
	[0mclass_balanced: False
	optimizer: adam
	freeze_bn: True
	pretrained: True
	[36mlr: 1e-05
	[0mbatch_size: 32
	[36mweight_decay: 0.0001
	[0mrho: 0.05
	[36malpha: 0.001
	[0m[36mswad: False
	[0mswad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	indomain_test: False
Dataset:
	[CelebA_Blond] #envs=3, #classes=2
	env0: tr_env1 (#24266)
	env1: tr_env2 (#24266)
	env2: te_env (#1448)

[37m[36mINFO[0m[0m 03/13 10:52:35 | n_steps = 3000
[37m[36mINFO[0m[0m 03/13 10:52:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/13 10:52:35 | n_steps is updated to 3000 => 3001 for checkpointing
[37m[36mINFO[0m[0m 03/13 10:52:35 | Target test envs = [[0], [1], [2]]
[37m[36mINFO[0m[0m 03/13 10:52:35 | 
[37m[36mINFO[0m[0m 03/13 10:52:35 | Testenv name escaping te_tr_env1 -> te_tr_env1
[37m[36mINFO[0m[0m 03/13 10:52:35 | Test envs = [0], name = te_tr_env1
[37m[36mINFO[0m[0m 03/13 10:52:35 | Batch sizes for each domain: [0, 32, 32] (total=64)
[37m[36mINFO[0m[0m 03/13 10:52:35 | steps-per-epoch for each domain: 606.66, 36.22 -> min = 36.22
[37m[36mINFO[0m[0m 03/13 10:52:39 | # of params = 85800194
[37m[36mINFO[0m[0m 03/13 10:55:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_out    env2_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/13 10:55:30 | 0.505692    0.511642    0.000000    0.512804    0.813852    0.505692    0.511642    0.513497    0.512111    0           0.000000    1.032947    3.891720    166.732342 
[37m[36mINFO[0m[0m 03/13 11:01:38 | 0.956112    0.954049    0.000000    0.934884    0.158443    0.956112    0.954049    0.952813    0.916955    200         5.522002    0.306680    1.279730    111.665211 
[37m[36mINFO[0m[0m 03/13 11:07:46 | 0.960748    0.960025    0.000000    0.938468    0.152348    0.960748    0.960025    0.956522    0.920415    400         11.044003   0.177041    1.284691    111.231868 
[37m[36mINFO[0m[0m 03/13 11:13:50 | 0.963221    0.962085    0.000000    0.941126    0.142686    0.963221    0.962085    0.958376    0.923875    600         16.566005   0.160501    1.275519    108.792640 
[37m[36mINFO[0m[0m 03/13 11:19:53 | 0.966466    0.965382    0.000000    0.933321    0.154685    0.966466    0.965382    0.963528    0.903114    800         22.088007   0.139209    1.275082    108.450762 
[37m[36mINFO[0m[0m 03/13 11:25:56 | 0.963684    0.963322    0.000000    0.946831    0.143248    0.963684    0.963322    0.959407    0.934256    1000        27.610009   0.116745    1.276193    107.638330 
[37m[36mINFO[0m[0m 03/13 11:31:59 | 0.964714    0.963322    0.000000    0.944092    0.156530    0.964714    0.963322    0.960849    0.927336    1200        33.132010   0.094486    1.277169    107.685778 
[37m[36mINFO[0m[0m 03/13 11:38:02 | 0.968372    0.967443    0.000000    0.944710    0.147133    0.968372    0.967443    0.962085    0.927336    1400        38.654012   0.093308    1.276455    107.836371 
[37m[36mINFO[0m[0m 03/13 11:44:05 | 0.963890    0.964558    0.000000    0.947243    0.138249    0.963890    0.964558    0.960231    0.934256    1600        44.176014   0.083932    1.276314    107.641858 
[37m[36mINFO[0m[0m 03/13 11:50:11 | 0.968423    0.967443    0.000000    0.930582    0.164762    0.968423    0.967443    0.964970    0.896194    1800        49.698016   0.075289    1.277063    110.254787 
[37m[36mINFO[0m[0m 03/13 11:56:16 | 0.968114    0.966206    0.000000    0.944814    0.154086    0.968114    0.966206    0.962291    0.927336    2000        55.220017   0.065471    1.280465    108.441585 
[37m[36mINFO[0m[0m 03/13 12:02:19 | 0.966054    0.963116    0.000000    0.933506    0.181241    0.966054    0.963116    0.960437    0.906574    2200        60.742019   0.059025    1.277155    107.743848 
[37m[36mINFO[0m[0m 03/13 12:08:22 | 0.971771    0.967031    0.000000    0.937296    0.167794    0.971771    0.967031    0.964558    0.910035    2400        66.264021   0.063634    1.274662    108.356365 
[37m[36mINFO[0m[0m 03/13 12:14:25 | 0.969814    0.965588    0.000000    0.947677    0.157127    0.969814    0.965588    0.964558    0.930796    2600        71.786022   0.056171    1.277045    108.003150 
[37m[36mINFO[0m[0m 03/13 12:20:28 | 0.969608    0.968267    0.000000    0.938614    0.185535    0.969608    0.968267    0.963734    0.913495    2800        77.308024   0.058543    1.276454    107.659411 
[37m[36mINFO[0m[0m 03/13 12:26:31 | 0.970896    0.970122    0.000000    0.938717    0.192356    0.970896    0.970122    0.963940    0.913495    3000        82.830026   0.046890    1.276123    107.738286 
[37m[36mINFO[0m[0m 03/13 12:26:31 | ---
[37m[36mINFO[0m[0m 03/13 12:26:31 | oracle = 97.090%
[37m[36mINFO[0m[0m 03/13 12:26:31 | iid = 96.981%
[37m[36mINFO[0m[0m 03/13 12:26:31 | last = 97.090%
[37m[36mINFO[0m[0m 03/13 12:26:31 | last (inD) = 93.872%
[37m[36mINFO[0m[0m 03/13 12:26:31 | iid (inD) = 94.768%
[37m[36mINFO[0m[0m 03/13 12:26:31 | 
[37m[36mINFO[0m[0m 03/13 12:26:32 | Testenv name escaping te_tr_env2 -> te_tr_env2
[37m[36mINFO[0m[0m 03/13 12:26:32 | Test envs = [1], name = te_tr_env2
[37m[36mINFO[0m[0m 03/13 12:26:32 | Batch sizes for each domain: [32, 0, 32] (total=64)
[37m[36mINFO[0m[0m 03/13 12:26:32 | steps-per-epoch for each domain: 606.66, 36.22 -> min = 36.22
[37m[36mINFO[0m[0m 03/13 12:26:34 | # of params = 85800194
[37m[36mINFO[0m[0m 03/13 12:28:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_out    env1_in     env1_out    env2_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/13 12:28:26 | 0.538042    0.529775    0.000000    0.534123    0.764974    0.521533    0.538042    0.529775    0.546713    0           0.000000    1.091926    1.274575    110.496597 
[37m[36mINFO[0m[0m 03/13 12:34:29 | 0.949106    0.955698    0.000000    0.935811    0.154373    0.954667    0.949106    0.955698    0.916955    200         5.522002    0.301039    1.275969    107.930526 
[37m[36mINFO[0m[0m 03/13 12:40:32 | 0.958739    0.964970    0.000000    0.934145    0.153602    0.965176    0.958739    0.964970    0.903114    400         11.044003   0.171605    1.274016    108.060390 
[37m[36mINFO[0m[0m 03/13 12:46:36 | 0.950085    0.952195    0.000000    0.937254    0.160745    0.957552    0.950085    0.952195    0.916955    600         16.566005   0.134193    1.276060    108.262762 
[37m[36mINFO[0m[0m 03/13 12:52:39 | 0.957348    0.958788    0.000000    0.939232    0.142847    0.964970    0.957348    0.958788    0.913495    800         22.088007   0.121622    1.275805    108.535763 
[37m[36mINFO[0m[0m 03/13 12:58:43 | 0.954824    0.956522    0.000000    0.936575    0.155658    0.963116    0.954824    0.956522    0.910035    1000        27.610009   0.104890    1.277665    108.499333 
[37m[36mINFO[0m[0m 03/13 13:04:47 | 0.960027    0.962703    0.000000    0.944032    0.162844    0.967649    0.960027    0.962703    0.920415    1200        33.132010   0.090543    1.278119    108.367716 
[37m[36mINFO[0m[0m 03/13 13:10:51 | 0.960645    0.962910    0.000000    0.941396    0.178037    0.969297    0.960645    0.962910    0.913495    1400        38.654012   0.074416    1.275116    108.362803 
[37m[36mINFO[0m[0m 03/13 13:16:54 | 0.960181    0.962910    0.000000    0.937318    0.166551    0.968061    0.960181    0.962910    0.906574    1600        44.176014   0.068320    1.274001    108.466619 
[37m[36mINFO[0m[0m 03/13 13:22:56 | 0.961624    0.962910    0.000000    0.937112    0.172003    0.967649    0.961624    0.962910    0.906574    1800        49.698016   0.059022    1.274724    107.291570 
[37m[36mINFO[0m[0m 03/13 13:28:59 | 0.961263    0.962497    0.000000    0.932046    0.194655    0.971358    0.961263    0.962497    0.892734    2000        55.220017   0.050669    1.274493    108.115884 
[37m[36mINFO[0m[0m 03/13 13:35:03 | 0.961006    0.960643    0.000000    0.932952    0.203675    0.969709    0.961006    0.960643    0.896194    2200        60.742019   0.043760    1.277368    108.306702 
[37m[36mINFO[0m[0m 03/13 13:41:06 | 0.960593    0.961673    0.000000    0.932849    0.210620    0.969503    0.960593    0.961673    0.896194    2400        66.264021   0.046867    1.275515    107.788902 
[37m[36mINFO[0m[0m 03/13 13:47:10 | 0.961521    0.963734    0.000000    0.929101    0.225906    0.972388    0.961521    0.963734    0.885813    2600        71.786022   0.035859    1.276709    108.382653 
[37m[36mINFO[0m[0m 03/13 13:53:12 | 0.962242    0.963940    0.000000    0.932952    0.196991    0.969709    0.962242    0.963940    0.896194    2800        77.308024   0.041880    1.277109    107.213606 
[37m[36mINFO[0m[0m 03/13 13:59:15 | 0.961675    0.962703    0.000000    0.925228    0.225422    0.971564    0.961675    0.962703    0.878893    3000        82.830026   0.033966    1.274483    107.622189 
[37m[36mINFO[0m[0m 03/13 13:59:15 | ---
[37m[36mINFO[0m[0m 03/13 13:59:15 | oracle = 95.874%
[37m[36mINFO[0m[0m 03/13 13:59:15 | iid = 96.003%
[37m[36mINFO[0m[0m 03/13 13:59:15 | last = 96.168%
[37m[36mINFO[0m[0m 03/13 13:59:15 | last (inD) = 92.523%
[37m[36mINFO[0m[0m 03/13 13:59:15 | iid (inD) = 94.403%
[37m[36mINFO[0m[0m 03/13 13:59:15 | 
[37m[36mINFO[0m[0m 03/13 13:59:16 | Testenv name escaping te_te_env -> te_te_env
[37m[36mINFO[0m[0m 03/13 13:59:16 | Test envs = [2], name = te_te_env
[37m[36mINFO[0m[0m 03/13 13:59:16 | Batch sizes for each domain: [32, 32, 0] (total=64)
[37m[36mINFO[0m[0m 03/13 13:59:16 | steps-per-epoch for each domain: 606.66, 606.66 -> min = 606.66
[37m[36mINFO[0m[0m 03/13 13:59:18 | # of params = 85800194
[37m[36mINFO[0m[0m 03/13 14:00:02 | test_in     test_out    train_in    train_out   tr_outloss  env0_out    env1_out    env2_in     env2_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/13 14:00:02 | 0.530630    0.525952    0.000000    0.749536    0.538609    0.761179    0.737894    0.530630    0.525952    0           0.000000    0.926945    1.262094    43.079499  
[37m[36mINFO[0m[0m 03/13 14:05:01 | 0.800690    0.826990    0.000000    0.967958    0.090641    0.972388    0.963528    0.800690    0.826990    200         0.329676    0.175823    1.275782    42.974387  
[37m[36mINFO[0m[0m 03/13 14:09:59 | 0.786022    0.823529    0.000000    0.968782    0.085178    0.973625    0.963940    0.786022    0.823529    400         0.659352    0.102942    1.276697    43.089894  
[37m[36mINFO[0m[0m 03/13 14:14:56 | 0.830026    0.847751    0.000000    0.970637    0.076952    0.976097    0.965176    0.830026    0.847751    600         0.989028    0.090359    1.273934    42.580900  
[37m[36mINFO[0m[0m 03/13 14:19:54 | 0.797239    0.816609    0.000000    0.969297    0.082248    0.974655    0.963940    0.797239    0.816609    800         1.318704    0.098832    1.276166    42.800507  
[37m[36mINFO[0m[0m 03/13 14:24:53 | 0.799827    0.823529    0.000000    0.970946    0.076897    0.976921    0.964970    0.799827    0.823529    1000        1.648380    0.089398    1.275932    43.190467  
[37m[36mINFO[0m[0m 03/13 14:29:51 | 0.822261    0.840830    0.000000    0.971976    0.074342    0.977746    0.966206    0.822261    0.840830    1200        1.978056    0.085897    1.276816    43.139226  
[37m[36mINFO[0m[0m 03/13 14:34:50 | 0.807593    0.840830    0.000000    0.971358    0.073341    0.977334    0.965382    0.807593    0.840830    1400        2.307732    0.080451    1.277053    43.218828  
[37m[36mINFO[0m[0m 03/13 14:39:49 | 0.826575    0.847751    0.000000    0.972388    0.073052    0.977540    0.967237    0.826575    0.847751    1600        2.637408    0.079463    1.276506    43.236216  
[37m[36mINFO[0m[0m 03/13 14:44:47 | 0.862813    0.875433    0.000000    0.969709    0.078844    0.973419    0.966000    0.862813    0.875433    1800        2.967084    0.076449    1.277623    43.121091  
[37m[36mINFO[0m[0m 03/13 14:49:46 | 0.835203    0.854671    0.000000    0.973625    0.070726    0.978158    0.969091    0.835203    0.854671    2000        3.296760    0.075017    1.277945    43.057471  
[37m[36mINFO[0m[0m 03/13 14:54:45 | 0.823986    0.847751    0.000000    0.972285    0.072328    0.977128    0.967443    0.823986    0.847751    2200        3.626436    0.070789    1.277925    43.547762  
[37m[36mINFO[0m[0m 03/13 14:59:44 | 0.817947    0.844291    0.000000    0.972594    0.070741    0.977540    0.967649    0.817947    0.844291    2400        3.956112    0.074171    1.277510    43.425590  
[37m[36mINFO[0m[0m 03/13 15:04:43 | 0.835203    0.851211    0.000000    0.973315    0.071123    0.978364    0.968267    0.835203    0.851211    2600        4.285788    0.071696    1.278664    43.315912  
[37m[36mINFO[0m[0m 03/13 15:09:42 | 0.827437    0.865052    0.000000    0.974037    0.070386    0.977746    0.970328    0.827437    0.865052    2800        4.615464    0.070427    1.278735    43.202077  
[37m[36mINFO[0m[0m 03/13 15:14:41 | 0.826575    0.840830    0.000000    0.972903    0.070946    0.976921    0.968885    0.826575    0.840830    3000        4.945140    0.070999    1.278041    43.339909  
[37m[36mINFO[0m[0m 03/13 15:14:41 | ---
[37m[36mINFO[0m[0m 03/13 15:14:41 | oracle = 86.281%
[37m[36mINFO[0m[0m 03/13 15:14:41 | iid = 82.744%
[37m[36mINFO[0m[0m 03/13 15:14:41 | last = 82.657%
[37m[36mINFO[0m[0m 03/13 15:14:41 | last (inD) = 97.290%
[37m[36mINFO[0m[0m 03/13 15:14:41 | iid (inD) = 97.404%
[37m[36mINFO[0m[0m 03/13 15:14:41 | === Summary ===
[37m[36mINFO[0m[0m 03/13 15:14:41 | Command: train_all.py CB0 --dataset CelebA_Blond --data_dir /home/guanglinzhou/scratch/domainbed/dataset --deterministic --trial_seed 0 --algorithm SAGM_DG --alpha 0.001 --lr 1e-5 --weight_decay 1e-4 --resnet_dropout 0.5 --swad False --steps 3000
[37m[36mINFO[0m[0m 03/13 15:14:41 | Unique name: 240313_10-52-34_CB0
[37m[36mINFO[0m[0m 03/13 15:14:41 | Out path: train_output/CelebA_Blond/240313_10-52-34_CB0
[37m[36mINFO[0m[0m 03/13 15:14:41 | Algorithm: SAGM_DG
[37m[36mINFO[0m[0m 03/13 15:14:41 | Dataset: CelebA_Blond
+------------+---------+---------+---------+---------+
| Selection  | tr_env1 | tr_env2 |  te_env |   Avg.  |
+------------+---------+---------+---------+---------+
|   oracle   | 97.090% | 95.874% | 86.281% | 93.082% |
|    iid     | 96.981% | 96.003% | 82.744% | 91.909% |
|    last    | 97.090% | 96.168% | 82.657% | 91.972% |
| last (inD) | 93.872% | 92.523% | 97.290% | 94.562% |
| iid (inD)  | 94.768% | 94.403% | 97.404% | 95.525% |
+------------+---------+---------+---------+---------+
